{"id":"5604","user":{"id":"144068","nickname":"Mr.Crack","avatar_url":"https://static.codemao.cn/Fm1dZPD5kvkL1kOTeZt6E0TIzoAB","subject_id":0,"work_shop_name":"","work_shop_level":0,"wuhan_medal":false,"has_signed":false},"title":"【新发现】右键菜单、文件关联与desktop.ini的黑科技","content":"<p><p>这几天，我在电脑上瞎捣腾，发现了三个事情。</p>\n<p>0.准备工作</p>\n<p>在进行以下一系列操作之前，请打开文件夹选项，然后在“查看”选择夹中取消勾选“隐藏已知文件类型的扩展名”。</p>\n<p><img src=\"https://static.codemao.cn/Fug3RgVl4rstt4-byqIFSpBHAYMU\"></p>\n<p><img src=\"https://static.codemao.cn/Fhe8lYKHfs1Ib4E6dQCGwSoZckgP\"></p>\n<p>1.右键菜单</p>\n<p>软件经常会在右键菜单中创建新的选项，有的有图标，有的没图标，有的对于啥玩意都适用，有的只限于几种文件类型。这是怎么做到的呢？</p>\n<p>于是，我打开“管理员获得所有权”的注册表编辑文件，发现了点东东。。。<br></p>\n<p><img src=\"https://static.codemao.cn/FvrK_okzoD1Lq3ZcHGT6TzGrBp3Z\"></p>\n<p>接着我打开注册表编辑器一看。。。<br></p>\n<p><img src=\"https://static.codemao.cn/FqhllLON9Q03827DxuBO2TbwI_ND\"></p>\n<p>WOW...</p>\n<p>新建一个适用于exe文件的右键菜单方法：</p>\n<p>①打开regedit</p>\n<p><img src=\"https://static.codemao.cn/FslNAllIdj-PxDe2ym-MLknVbnFG\"></p>\n<p>▲不会运行就搜一下，何有找不到之理。。。</p>\n<p>②展开 HKEY_CLASSES_ROOT(以后简称HKCR)-&gt;exefile-&gt;shell，注册表是以字母排序的，应该不会太难找。<br></p>\n<p><img src=\"https://static.codemao.cn/FhivdqKTnNQIbrxU-NjOROFcn3yp\"></p>\n<p>③右键shell文件夹，新建项。名字随意，但注意：右键菜单将会以项名称的字母顺序排序。</p>\n<p><img src=\"https://static.codemao.cn/FgblWLqygwvnqJHwGPR_lSOxYT2s\"></p>\n<p>④将右侧默认值设定为选项的名称。若要插入分割线，请设置为“-”，若要使按下指定按键就能直接选中此选项，请在选项名称中包含此字母，然后在字母前面加上“&amp;”。若选项名中需要有“&amp;”字符，用“&amp;&amp;”即可。</p>\n<p><img src=\"https://static.codemao.cn/FhIXT6Ez6U2Li9A1NiVeX4-Ok0V4\"></p>\n<p>▲含义为：右键菜单中此选项显示为“打开命令行(J)”，按下J即可直接执行。</p>\n<p>⑤右键刚才新建的项，在新建一个名曰command的项目。设置其默认值为点击后执行的命令行。此处为“打开命令行”，故命令为“cmd”。</p>\n<p><img src=\"https://static.codemao.cn/FmHk8ppFpQyz0VCxJIKxKHMYYrH2\"></p>\n<p>⑥我们做的这个右键菜单只用于exe文件，所以我们右键一个exe文件，然后测试效果。</p>\n<p><img src=\"https://static.codemao.cn/Ft0YYspdjLb2nAcHNCK1TzPOmK1w\"></p>\n<p>⑦如何为选项添加图标：当你选择文件夹的图标时，若选取exe、dll等文件，会出来一大堆图标。故在test下新建Icon项（注意大写）。其值设置为：绝对文件名+\",\"+到文本(图标在文件中的序号-1)<img src=\"https://static.codemao.cn/FkkJ_4qUj8V-ueFNVFsAHk_hUSYY\"></p>\n<p><img src=\"https://static.codemao.cn/FpuaU1-rzR8nOJjA2c6Dx0Aeepds\"></p>\n<p>⑧再进行测试。<br></p>\n<p><img src=\"https://static.codemao.cn/FkDUc6CMMEX2qik0SL78fJCWu_Ve\"></p>\n<p>⑨若要移除此右键菜单，只需删除test项。</p>\n<p><img src=\"https://static.codemao.cn/FtVmj3j1V8XQl7-XBIS_gHUL0MqB\"></p>\n<p>⑩若要建立适用于文件夹的右键菜单，则第二步应当展开 HKCR-&gt;Directory-&gt;shell. 若要建立适用于除exe外其他文件的右键菜单，应当展开 HKCR-&gt;*-&gt;shell</p>\n<p>Error若要建立适用于txt的右键菜单，先在注册表中展开 HKCR-&gt;.txt （前面有个点），然后查看其默认值<br></p>\n<p><img src=\"https://static.codemao.cn/Fs-AlYB5TUqH00ZDNi-JDT-kKNwF\"></p>\n<p>Error再展开 HKCR-&gt;刚才看到的值-&gt;shell。比如HKCR-&gt;Heinote.txtfile-&gt;shell。</p>\n<p><img src=\"https://static.codemao.cn/FqcKdh8dIOKnTlvKxUSrl68AxPw9\"></p>\n<p>Error然后再按步骤③-⑨进行操作即可。</p>\n<p>2.文件关联</p>\n<p>经验来自网络</p>\n<p>如何建立一个文件关联：</p>\n<p>①在HKCR下建立项，命名为“.”+文件后缀。</p>\n<p><img src=\"https://static.codemao.cn/FoRATgeTp7FB4MvMp2K__bOYDNDf\"></p>\n<p>②将默认值修改为 后缀+“file” 或随意命名。然后再在HKCR中建立一个文件夹（刚才默认值怎么设置就怎么命名）<br></p>\n<p><img src=\"https://static.codemao.cn/Foj3gqJCCH-X88ne-btB29XP_4tj\"></p>\n<p><img src=\"https://static.codemao.cn/Fis4WrR2dVt3Qiuq91l0hedrMx_E\"></p>\n<p>③将默认值设置为文件类型的名称</p>\n<p><img src=\"https://static.codemao.cn/Fl362R00QQy1Q2jTpHz5DHdwzU5w\"></p>\n<p>④新建字符串值FriendlyTypeName，设置为文件类型的描述。</p>\n<p><img src=\"https://static.codemao.cn/Fon036B9UJeontKXbkGBV5hFNGY1\"></p>\n<p>⑤新建项DefaultIcon，将默认值改为图标路径。</p>\n<p><img src=\"https://static.codemao.cn/Fv6_IKikMOznNqr5DEJOkfy5OGGy\"></p>\n<p>⑥新建项OpenCommand，修改默认值为打开文件的命令行。用%1代表当前文件，通常需要加引号。</p>\n<p><img src=\"https://static.codemao.cn/FkdCMzL9HsAZ9bLlSTJjdd3PU2qS\"></p>\n<p>⑦新建一个key文件，查看效果。</p>\n<p>3.文件夹附加属性</p>\n<p>有一个很好的例子，就是“图片-&gt;保存的图片”文件夹虽然叫做“保存的图片”，但是，它的真实名字却是Saved Pictures，因为在命令行中必须使用这个名字才有效。</p>\n<p><img src=\"https://static.codemao.cn/Ft_6doAuSxjDS64H09bs1m0892Na\"></p>\n<p>这个搞得我一头雾水，这是怎么做到的？Windows系统可以这么权威化吗？</p>\n<p>有一天，我将“保存的图片”文件夹复制到桌面中，然后用自己做的加密器进行加密，结果发现了一个见鬼的东西。。。</p>\n<p><img src=\"https://static.codemao.cn/Fnl6b_M6lUcLFfzzCGwXWlkHu0Zp\"></p>\n<p>这是神马文件？我发现即使勾选了<img src=\"https://static.codemao.cn/FiyCafwf1gVz_kDwfbjLg8YVHXZW\">选项，我仍然找不到这个文件。</p>\n<p>于是我决定用命令行确认它的存在。</p>\n<p><img src=\"https://static.codemao.cn/FgHljGYzZ1HIXgQDubmk_idQUe7l\"></p>\n<p>原来喵。。。</p>\n<p>我试着修改了数值。</p>\n<p><img src=\"https://static.codemao.cn/Fr5A6IlPJcYRu8c-YcuEHYVUUcra\"></p>\n<p><img src=\"https://static.codemao.cn/Fmt1BxfRGbBrVezxzAkDATL4rfRQ\"></p>\n<p>原来喵2.0</p>\n<p>如何设置文件夹或U盘图标（在任何电脑上都有效）</p>\n<p>文件夹：</p>\n<p>①我们经常给U盘中的文件夹设置图标，可是，喵特，这种图标通常一到其他电脑上就完美失效。。。那么，如何设置一个永久有效的图标呢？</p>\n<p>②制作或提取自己需要的图标，放在这个文件夹内，命名为default.ico。</p>\n<p><img src=\"https://static.codemao.cn/Fu-y9TYh5jMby4A6KZgR9So_X8yK\"></p>\n<p>③在文件夹中新建记事本文档“desktop.ini”，然后打开。</p>\n<p><img src=\"https://static.codemao.cn/FtseHECjVr-UurTxbdHjCM_jyAwB\"></p>\n<p>④将以下内容复制到文本文档中。</p>\n<p>[.ShellClassInfo]</p>\n<p>LocalizedResourceName=</p>\n<p>IconResource=.\\default.ico,0</p>\n<p>InfoTip=</p>\n<p>▲其中LocalizedResourceName为文件夹别名，会在文件资源管理器中显示，而且，用户重命名将会改动它，而不会改动文件夹的真名。IconResource乃图标，InfoTip当鼠标悬停在文件夹上方时就会显示。改动第一个和第三个即可。</p>\n<p><img src=\"https://static.codemao.cn/Fg4t0Cefj4Fcns3l13VBlcOZPTRO\"></p>\n<p>⑤保存文件，然后在文件夹的 属性-&gt;自定义 中随意给出一个图标。</p>\n<p><img src=\"https://static.codemao.cn/Fk36ndDIQrhu7cdyzGZQFnM72rYF\"></p>\n<p>⑥重新打开desktop.ini，修改IconResource为.\\default.ico,0。使用 attrib +s +h 文件全名 彻底隐藏desktop.ini 和 default.ico。立即生效。</p>\n<p><img src=\"https://static.codemao.cn/FoUloCQRSVVsEbNjfPAmnn7k9qZn\"></p>\n<p>U盘图标：</p>\n<p>①进入U盘根目录，创建文件autorun.inf，将以下内容复制进去。</p>\n<p>[autorun] </p>\n<p>ICON=icon.ico,0</p>\n<p><img src=\"https://static.codemao.cn/FhkuaNWXzcQ9rjLzq40Jp1fcDoxT\"></p>\n<p>②提取或制作图标，重命名为icon.ico后放在根目录下。</p>\n<p><img src=\"https://static.codemao.cn/FlhKz_1Dzh8N9IzH37PwYZ-gTfp1\"></p>\n<p>③利用attrib命令彻底隐藏两个文件。</p></p>","board_id":"2","board_name":"积木编程乐园","updated_at":1502775465,"created_at":1502775296,"n_views":280,"n_replies":4,"n_comments":0,"is_authorized":false,"is_featured":false,"is_hotted":false,"is_pinned":false,"tutorial_flag":0,"ask_help_flag":0}