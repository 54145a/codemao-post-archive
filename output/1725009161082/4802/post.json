{"id":"4802","user":{"id":"144068","nickname":"Mr.Crack","avatar_url":"https://static.codemao.cn/Fm1dZPD5kvkL1kOTeZt6E0TIzoAB","subject_id":0,"work_shop_name":"","work_shop_level":0,"wuhan_medal":false,"has_signed":false},"title":"【易语言程序】文件锁","content":"<p><img src=\"https://static.codemao.cn/Fh3Ph8MZc5iFPs4wD0Ym5bAPN-af\"><br></p>\n<p>源代码：[文件锁.e]&nbsp;<a rel=\"nofollow\"></a><a href=\"https://static.codemao.cn/FhKIiC_tj_Mbs_VveT6yVsvmi6HG\" rel=\"nofollow\">https://static.codemao.cn/FhKIiC_tj_Mbs_VveT6yVsvmi6HG</a></p>\n<p>程序：[文件锁.exe]&nbsp;<a rel=\"nofollow\"></a><a href=\"https://static.codemao.cn/FgGTKdCaRM2m68dRNpd2JNFGjJJe\" rel=\"nofollow\">https://static.codemao.cn/FgGTKdCaRM2m68dRNpd2JNFGjJJe</a></p>\n<p>引用的模块：[编码转换器.ec]&nbsp;<a rel=\"nofollow\"></a><a href=\"https://static.codemao.cn/FjaELxQxP__vXoyohbwEglCcBjFT\" rel=\"nofollow\">https://static.codemao.cn/FjaELxQxP__vXoyohbwEglCcBjFT</a></p>\n<p>======================================================</p>\n<p>0.程序的下载</p>\n<p>若您无法下载，请复制链接到迅雷下载（不用管文件名很奇怪，它是随机的）</p>\n<p>*.e请用易语言打开。</p>\n<p>*.exe请直接执行。</p>\n<p>你可以将程序的快捷方式放到C:\\Users\\yezhi\\AppData\\Roaming\\Microsoft\\Windows\\Start&nbsp;Menu\\Programs\\易语言程序</p>\n<p>方便以后使用。</p>\n<p><img src=\"https://static.codemao.cn/FplGkVWuX_nqrk6TMhot4DYebvu5\"><br></p>\n<p>▲手动放到开始菜单的程序</p>\n<p>1.程序原理</p>\n<p>文件锁定的原理是以“不共享”的方式进行占用，导致文件无法被读/写。</p>\n<p><img src=\"https://static.codemao.cn/Fs-KsqyBjYu2q6IOFf_OYcGGyAfn\"><br></p>\n<p>▲文件锁定的源代码</p>\n<p>程序的数据文件放在了 取运行目录 () + \"\\data\" 下，进行了两层保护，一是用25位的36进制数作为密码进行DES加密，二是程序运行时，也会用以上方法锁定文件。</p>\n<p><img src=\"https://static.codemao.cn/FuCZUwo5AUvZ0Np6w6UJjKpPQ-Ii\"><br></p>\n<p>▲文件被加密并伪装为cat（数据文件在程序首次启动时自动创建）</p>\n<p>当你不在运行本程序时，数据文件是不安全的，随时可以被删除重置（除非你设置了权限）。但程序运行时，你不能删除数据。</p>\n<p><img src=\"https://static.codemao.cn/Fm1rZ6JvB2DEJ0CALXDsbaB5KaqE\"><br></p>\n<p>▲无法删除数据文件（程序运行时）</p>\n<p>当程序本身需要数据文件时，将会这样进行操作：</p>\n<p><img src=\"https://static.codemao.cn/FqHV6f6JcwTY5RF1PeG_KVxMxcx2\"><br></p>\n<p>▲先解锁文件后再读取，读取之后立即锁定。</p>\n<p><img src=\"https://static.codemao.cn/FqV2syPkPBkBf7xJyvIEX2nW6TOl\"><br></p>\n<p>▲为了安全，我们同样对任务管理器进行了限制。</p>\n<p><img src=\"https://static.codemao.cn/FqC4QvzH7mWyCsiQ39bjsQj8o4Xt\"><br></p>\n<p>▲密码被MD5之后再加密（不可逆）</p>\n<p>2.使用说明</p>\n<p><img src=\"https://static.codemao.cn/Fuvp-iwKrheCNIBfMIkGAleXAHTK\"><br></p>\n<p>▲每一次启动程序时，程序都会要求提供密码，若密码不正确，程序将自动关闭。若你是初次启动，或你没有设置过密码，请直接点击“确定”。</p>\n<p><img src=\"https://static.codemao.cn/FusP601c_WFDbhsH1ZsnrDyjHcxP\"><br></p>\n<p>▲启动后，程序将启动在托盘图标中。单击打开程序主界面（默认需要密码），右键弹出菜单。</p>\n<p><img src=\"https://static.codemao.cn/FloDrd7Rv4Pnwbuj8ja1cu3fNE8t\"><br></p>\n<p>▲在主界面或右键菜单中打开选项</p>\n<p><img src=\"https://static.codemao.cn/FjecwPYuqN3e85yXP9AaUairfXna\"><br></p>\n<p>▲“需要密码”板块中的“修改密码时”与“打开选项时”不应该被修改。你可以设置开机启动“#到启动组”</p>\n<p><img src=\"https://static.codemao.cn/FpCLPbCB9qEaXsDXdr14K24LB8ri\"><br></p>\n<p>▲你可以设置新密码，还可以包含特殊字符。</p>\n<p><img src=\"https://static.codemao.cn/Fg_v2JokSHCEIuby9MCc26PMKtPy\"><br></p>\n<p>▲你必须勾选“显示密码”项目，才能够输入特殊字符。</p>\n<p><img src=\"https://static.codemao.cn/FkuItZ2RTSLqpYWjZxNFa8mOwEme\"><br></p>\n<p>▲在主界面上选择“添加”，然后加入欲锁定的文档。点击右侧按钮浏览文件。</p>\n<p><img src=\"https://static.codemao.cn/FhvtKq3sOimRY7uhKuFM12EPuL-5\"><br></p>\n<p>▲你可以尝试用软件打开此文件，一个也打不开。在列表中选择此项目，然后删除，即可恢复文件可用性。这个锁定文件的列表储存在“locked.cat”中，反正你没法手动编辑（加密的。。。）</p>\n<p><img src=\"https://static.codemao.cn/FrnY9PlpVwj5ZjNTzh0Sn4F9rNdx\"><br></p>\n<p>▲若你在“选项”中启用，使用任务管理器需要提供密码。提供密码后，点击“解锁”，任务管理器使用完毕后，点击“完成”。</p>\n<p><img src=\"https://static.codemao.cn/FoLHWkJ23E62QSXL5ZK5EHBCAh2g\"><br></p>\n<p>▲还可以加密exe。</p>\n<p><img src=\"https://static.codemao.cn/Fq3gE5qBs4kFVNT4dq1DvRpqa8e8\"><br></p>\n<p>▲退出也是需要密码的。</p>\n<p>======================================================</p>\n<p>重要提示：</p>\n<p>当前为测试版，若出现软件出BUG无法退出还限制了功能，请使用taskkill命令关闭此软件。</p>","board_id":"7","board_name":"灌水池塘","updated_at":1515977561,"created_at":1499589503,"n_views":131,"n_replies":12,"n_comments":0,"is_authorized":false,"is_featured":false,"is_hotted":false,"is_pinned":false,"tutorial_flag":0,"ask_help_flag":0}