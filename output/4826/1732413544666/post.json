{"id":"4826","user":{"id":"144068","nickname":"Mr.Crack","avatar_url":"https://static.codemao.cn/Fm1dZPD5kvkL1kOTeZt6E0TIzoAB","subject_id":0,"work_shop_name":"","work_shop_level":0,"wuhan_medal":false,"has_signed":false},"title":"【易语言程序】文件加密与解密（独立便捷版）","content":"<p><p><img src=\"https://static.codemao.cn/FpJ0-k1VFAKWTySZDvSmfPaTp-WR\"><br></p>\n<p>源代码 [文件加密.e]&nbsp;<a rel=\"nofollow\"></a><a href=\"https://static.codemao.cn/FvPkud0i2ZhuAJwQpa44ylbbtwbe\" rel=\"nofollow\">https://static.codemao.cn/FvPkud0i2ZhuAJwQpa44ylbbtwbe</a></p>\n<p>程序 [fileCrypt.exe]&nbsp;<a rel=\"nofollow\"></a><a href=\"https://static.codemao.cn/Fu7st55KIQ4kcYmWf1-sG948hgTV\" rel=\"nofollow\">https://static.codemao.cn/Fu7st55KIQ4kcYmWf1-sG948hgTV</a></p>\n<p>===============================================</p>\n<p>0.程序的下载</p>\n<p>若您无法下载，请复制链接到迅雷下载（不用管文件名很奇怪，它是随机的）</p>\n<p>*.e请用易语言打开。</p>\n<p>*.exe请直接执行。</p>\n<p>建议将EXE放在单独的文件夹中，因为该exe还会创建icons与tmp两个目录。（请不要删除！）</p>\n<p>你可以将程序的快捷方式放到C:\\Users\\yezhi\\AppData\\Roaming\\Microsoft\\Windows\\Start&nbsp;Menu\\Programs\\易语言程序</p>\n<p>方便以后使用。</p>\n<p><img src=\"https://static.codemao.cn/FsGJ8R1qGwP5Lx5J9iM239J1GQq7\"><br></p>\n<p>▲添加到开始菜单的程序</p>\n<p>1.特殊原理解析</p>\n<p>本程序是一个练习作品，主要练习对注册表的修改与控制台参数的读取。本作品用到的是：修改右键菜单、修改文件关联。</p>\n<p>文件关联代码如下：</p>\n<p>置文件关联&nbsp;(取运行目录&nbsp;()&nbsp;＋&nbsp;“\\”&nbsp;＋&nbsp;取执行文件名&nbsp;(),&nbsp;“cpr”,&nbsp;取运行目录&nbsp;()&nbsp;＋&nbsp;“\\icons\\fileicon.ico”,&nbsp;“已加密的文件”)</p>\n<p><img src=\"https://static.codemao.cn/FoRC0_L5g4zbkcGcq7WlXyFvXunZ\"><br></p>\n<p>.版本&nbsp;2 </p>\n<p>.子程序&nbsp;置文件关联,&nbsp;逻辑型,&nbsp;公开,&nbsp;关联指定后缀名的文件，双击对应的文件时就运行该应用程序 </p>\n<p>.参数&nbsp;关联应用程序,&nbsp;文本型,&nbsp;可空,&nbsp;当双击对应的文件时就运行该应用程序打开 </p>\n<p>.参数&nbsp;关联文件类型,&nbsp;文本型,&nbsp;可空,&nbsp;欲关联的文件类型，如“ABC” </p>\n<p>.参数&nbsp;关联文件图标,&nbsp;文本型,&nbsp;可空,&nbsp;ICO文件路径或EXE文件路径，注销后才有效 </p>\n<p>.参数&nbsp;关联类型描述,&nbsp;文本型,&nbsp;可空,&nbsp;文件管理器在“类型”列显示的的描述 </p>\n<p>.如果真&nbsp;(是否为空&nbsp;(关联应用程序)&nbsp;或&nbsp;是否为空&nbsp;(关联文件类型)&nbsp;或&nbsp;是否为空&nbsp;(关联文件图标)&nbsp;或&nbsp;是否为空&nbsp;(关联类型描述)) </p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;删除注册项&nbsp;(#根类,&nbsp;“.”&nbsp;＋&nbsp;“关联文件类型”) </p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;删除注册项&nbsp;(#根类,&nbsp;关联文件类型&nbsp;＋&nbsp;“file\\DefaultIcon”) </p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;删除注册项&nbsp;(#根类,&nbsp;关联文件类型&nbsp;＋&nbsp;“file\\shell\\open\\command”) </p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;删除注册项&nbsp;(#根类,&nbsp;关联文件类型&nbsp;＋&nbsp;“file\\shell\\open”) </p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;删除注册项&nbsp;(#根类,&nbsp;关联文件类型&nbsp;＋&nbsp;“file\\shell”) </p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;删除注册项&nbsp;(#根类,&nbsp;关联文件类型&nbsp;＋&nbsp;“file”) </p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;返回&nbsp;(假) </p>\n<p>.如果真结束 </p>\n<p>.如果真&nbsp;(写注册项&nbsp;(#根类,&nbsp;“.”&nbsp;＋&nbsp;关联文件类型&nbsp;＋&nbsp;“\\”,&nbsp;关联类型描述&nbsp;＋&nbsp;“file”)&nbsp;＝&nbsp;真&nbsp;且&nbsp;写注册项&nbsp;(#根类,&nbsp;关联文件类型&nbsp;＋&nbsp;“file\\”,&nbsp;关联类型描述)&nbsp;＝&nbsp;真&nbsp;且&nbsp;写注册项&nbsp;(#根类,&nbsp;关联文件类型&nbsp;＋&nbsp;“file\\DefaultIcon\\”,&nbsp;关联文件图标&nbsp;＋&nbsp;“,0”)&nbsp;＝&nbsp;真&nbsp;且&nbsp;写注册项&nbsp;(#根类,&nbsp;关联文件类型&nbsp;＋&nbsp;“file\\shell\\open\\command\\”,&nbsp;关联应用程序&nbsp;＋&nbsp;“&nbsp;”&nbsp;＋&nbsp;#引号&nbsp;＋&nbsp;“%1”&nbsp;＋&nbsp;#引号)&nbsp;＝&nbsp;真) </p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;返回&nbsp;(真) </p>\n<p>.如果真结束 </p>\n<p>返回&nbsp;(假) </p>\n<p>添加右键菜单代码如下：</p>\n<p>添加右键&nbsp;(“加密”,&nbsp;#引号&nbsp;＋&nbsp;取运行目录&nbsp;()&nbsp;＋&nbsp;“\\”&nbsp;＋&nbsp;取执行文件名&nbsp;()&nbsp;＋&nbsp;#引号&nbsp;＋&nbsp;“&nbsp;.encry&nbsp;”&nbsp;＋&nbsp;#引号&nbsp;＋&nbsp;“%1”&nbsp;＋&nbsp;#引号,&nbsp;“runas2”)</p>\n<p><img src=\"https://static.codemao.cn/Fo6_cxbQ6FaW7wvx6bhu5-rohZbJ\"><br></p>\n<p>.版本&nbsp;2 </p>\n<p>.子程序&nbsp;添加右键,&nbsp;逻辑型 </p>\n<p>.参数&nbsp;标签,&nbsp;文本型 </p>\n<p>.参数&nbsp;命令,&nbsp;文本型 </p>\n<p>.参数&nbsp;命令目录,&nbsp;文本型 </p>\n<p>.如果&nbsp;(写注册项&nbsp;(#根类,&nbsp;“*\\shell\\”&nbsp;＋&nbsp;命令目录&nbsp;＋&nbsp;“\\”,&nbsp;标签)&nbsp;且&nbsp;写注册项&nbsp;(#根类,&nbsp;“*\\shell\\”&nbsp;＋&nbsp;命令目录&nbsp;＋&nbsp;“\\command\\”,&nbsp;命令)) </p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;返回&nbsp;(真) </p>\n<p>.否则 </p>\n<p>&nbsp; &nbsp; 返回&nbsp;(假) </p>\n<p>▲该命令与“添加右键菜单”不同，该命令添加的菜单是对所有文件起作用的。本程序的右键菜单将会占用注册表的 HKCR\\*\\shell\\runas2 ，请保证这里没有其他菜单（否则将被覆盖）</p>\n<p>删除右键菜单代码如下：</p>\n<p>删除右键&nbsp;(“runas2”)</p>\n<p><img src=\"https://static.codemao.cn/FoJDqyCE2QV0EIzOZRdUmvdVylz9\"><br></p>\n<p>.版本&nbsp;2 </p>\n<p>.子程序&nbsp;删除右键 </p>\n<p>.参数&nbsp;命令目录,&nbsp;文本型 </p>\n<p>运行&nbsp;(“reg&nbsp;delete&nbsp;HKCR\\*\\shell\\”&nbsp;＋&nbsp;命令目录&nbsp;＋&nbsp;“&nbsp;/f”,&nbsp;真,&nbsp;#隐藏窗口)</p>\n<p>2.程序的基本使用方法（若看不懂，可忽略该部分，调到下一个）</p>\n<p><img src=\"https://static.codemao.cn/FsdpSg7lt_BYTXyqIz6HEUISy1sU\"><br></p>\n<p>▲新建一个文档用于测试加密</p>\n<p>运行以下代码，打开加密窗口：</p>\n<p>D: &nbsp;<font color=\"#c0c0c0\">注：此处输入exe存放盘符</font></p>\n<p>cd exe存放目录</p>\n<p>fileCrypt.exe .encry C:\\Users\\yezhi\\Desktop\\新建文件夹\\测试文档.txt</p>\n<p><img src=\"https://static.codemao.cn/Fk_Ydx3c3HRfG8d4amGm8vA6-4o0\"><br></p>\n<p>▲你将会得到这个窗口。设置密码并加密，此处使用123.</p>\n<p><img src=\"https://static.codemao.cn/FohHfm4G5yRRHWH-UcFcBV7D2LX5\"><br></p>\n<p>▲加密后你的文件将被追加cpr后缀，请不要擅自更改，否则可能无法正常解密。</p>\n<p>解密命令： fileCrypt&nbsp;C:\\Users\\yezhi\\Desktop\\新建文件夹\\测试文档.txt.cpr</p>\n<p><img src=\"https://static.codemao.cn/Fjl70Y-Lb5U0SydSaUW8QFOY0sAX\"><br></p>\n<p>▲你将得到一个解密窗口。你需要提供正确密码123，如果如图中提供1234，无法解密。</p>\n<p><img src=\"https://static.codemao.cn/FtnQGW3vHk0uHbBPjXhBi4AMxSub\"><br></p>\n<p>▲解密后，程序将会自动去掉，还原文档。</p>\n<p>2.用更方便的方法加密与解密</p>\n<p>先从开始菜单中直接打开程序，记得用管理员权限(UAC)运行。</p>\n<p><img src=\"https://static.codemao.cn/FpLXeZ8DtIvgwZHXHTBloTJlEo4J\"><br></p>\n<p>然后选择关联cpr（让你双击cpr文件就可以解密）与加入右键菜单（让你可以在右键中选取“加密”）</p>\n<p><img src=\"https://static.codemao.cn/Fl56Qi-yiRzi1Ub4_zkR-7ldsIKD\"><br></p>\n<p>选择一个待加密文件</p>\n<p><img src=\"https://static.codemao.cn/Fpf5nuoKlBdWVLtCszoXjtq9hkyS\"><br></p>\n<p>右键文件，选择加密。</p>\n<p><img src=\"https://static.codemao.cn/Fg2duwPMSB6VvRa_q5j9JfJ-zyqc\"><br></p>\n<p>设置密码并加密</p>\n<p><img src=\"https://static.codemao.cn/FvTS94t0PiH5oeUF28vz8yOHVGfF\"><br></p>\n<p>完成后你会得到cpr（之所以有图标与描述，是因为cpr被关联了）</p>\n<p><img src=\"https://static.codemao.cn/FqvvOZVWTI8gXFgTbh_nv4DBRxBU\"><br></p>\n<p>双击cpr，进行解密。需要提供加密时设置的密码。</p>\n<p><img src=\"https://static.codemao.cn/FstUUC8eSofQVC89nAKLCAQQ4M6y\"><br></p>\n<p>若密码正确，文档将会解密。</p>\n<p><img src=\"https://static.codemao.cn/Fpf5nuoKlBdWVLtCszoXjtq9hkyS\"></p>\n<p>3.特殊功能</p>\n<p>解密时，你会看到有2个选项，我们尝试选择第二个。</p>\n<p><img src=\"https://static.codemao.cn/FllKngM38Ee-I5N2YW_ADBY5zHZZ\"><br></p>\n<p>然后确定弹出的弹窗，将会打开编辑器（默认的编辑工具）。你可以对其进行修改，接着保存。</p>\n<p><img src=\"https://static.codemao.cn/FsjFQTgrECQICKFzRNQG6BMkDogT\"><br></p>\n<p>完成编辑之后，关闭编辑器，在托盘中找到临时编辑图标，点击。</p>\n<p><img src=\"https://static.codemao.cn/FtDpC6zRhFp9AiJdCOI8WqPIqZ5z\"><br></p>\n<p>点击后，图标如果消失，说明文件已经保存了。接下来，尝试解密这个文件。</p>\n<p><img src=\"https://static.codemao.cn/FhykexB1ehHg07w2WKBPP-Rg599b\"><br></p>\n<p>最后打开文件，你会发现临时编辑的内容已经起作用了。</p>\n<p><img src=\"https://static.codemao.cn/FrNchPytdT6lmpgaWuQfRrVZvWi2\"><br></p>\n<p>===============================================</p>\n<p>重要提示：</p>\n<p>1.使用DES进行加密，因为RC4没有密码自校验的功能。</p>\n<p>2.加密后文件大小应该差不多，会多出一点点（7字节左右）</p>\n<p>3.下载链接报错与BUG报告请跟帖。</p></p>","board_id":"7","board_name":"灌水池塘","updated_at":1499746084,"created_at":1499746084,"n_views":55,"n_replies":0,"n_comments":0,"is_authorized":false,"is_featured":false,"is_hotted":false,"is_pinned":false,"tutorial_flag":0,"ask_help_flag":0}